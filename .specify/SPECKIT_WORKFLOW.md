# GitHub SpecKit Workflow for graphiti-fastmcp

**Repository**: https://github.com/github/spec-kit
**Documentation**: https://github.com/github/spec-kit/blob/main/README.md

## What is SpecKit?

GitHub SpecKit is an open-source toolkit that makes **specifications executable**. Instead of specs being preliminary documentation, SpecKit generates working implementations directly from detailed specifications.

**Core Philosophy**: Spec-Driven Development - specifications translate directly into code, not just guidance.

---

## The Five Slash Commands

SpecKit provides a structured workflow through five commands:

### 1. `/speckit.constitution`
**Purpose**: Establish project governing principles before any feature work

**Creates**: `constitution.md` - Project governance, tech stack, testing standards

**When to use**:
- At project initialization
- When adopting new architectural patterns
- Before major feature development

**Example for graphiti-fastmcp**:
- Python 3.10+ with uv package management
- FalkorDB/Neo4j for graph storage
- Graphiti-core 0.24.1 (pinned for stability)
- Test-driven development with pytest
- Security: Never commit .env files with real API keys

---

### 2. `/speckit.specify`
**Purpose**: Document the "what" and "why" of a feature (NOT the "how")

**Creates**: `spec.md` - Functional requirements and user stories

**Focus on**:
- User value and business requirements
- Problem being solved
- Success criteria
- **Avoid**: Technology choices, implementation details

**Example prompt**:
```
/speckit.specify

Feature: FalkorDB Health Monitoring

Problem: FalkorDB Cloud free tier has 100MB limit. We need to monitor
usage proactively to prevent service disruption.

Requirements:
- Track total graph storage across all graphs
- Monitor per-graph statistics (nodes, edges, indices)
- Alert when usage exceeds 70% (warning) and 90% (critical)
- Provide actionable recommendations when approaching limits

Success criteria:
- Automated monitoring via CI/CD or scheduled checks
- Clear status reporting (OK/WARNING/CRITICAL)
- Integration with existing health check patterns
```

---

### 3. `/speckit.plan`
**Purpose**: AI generates the "how" - technical implementation strategy

**Creates**: `plan.md` - Architecture, tech choices, implementation approach

**Critical checkpoint**: **Human review required before proceeding**

**What to validate**:
- No over-engineering (unnecessary complexity)
- Aligns with constitution.md principles
- Considers existing patterns (e.g., scripts/check_falkordb_health.py)
- Feasible scope and dependencies

**Example review questions**:
- Does this need a new MCP server or can we extend existing checks?
- Should this integrate with GitHub Actions for automation?
- Is there an existing MCP server in the registry we can use?

---

### 4. `/speckit.tasks`
**Purpose**: Break plan into granular, ordered task checklist

**Creates**: `tasks.md` - Actionable checklist with dependencies

**Features**:
- Dependency tracking (task A before task B)
- Parallel execution markers
- Progress tracking

**Integration with GitHub Projects**:
Use `sync-tasks-to-projects.yml` workflow to create Issues from tasks.md for organizational visibility.

---

### 5. `/speckit.implement`
**Purpose**: Execute the task breakdown

**Process**:
- Agent works through tasks.md sequentially
- Commits code incrementally
- Creates Pull Request with:
  - Link to spec.md and plan.md
  - Plan-SHA (commit hash of plan.md for audit trail)
  - Task checklist in PR description

---

## Integration with graphiti-fastmcp Workflow

### Current Project Structure
```
graphiti-fastmcp/
├── .specify/              # SpecKit specifications (this folder)
│   ├── SPECKIT_WORKFLOW.md (this file)
│   └── [future specs go here]
├── .claude/
│   ├── commands/          # Slash commands
│   └── skills/            # Reusable agent skills
├── scripts/
│   └── check_falkordb_health.py  # Existing health check
├── architecture/          # Generated by ra_orchestrators
├── blog/                  # Session documentation
└── reference/             # Knowledge base
```

### Workflow Pattern

```mermaid
graph TD
    A[User Requirement] --> B[/speckit.constitution]
    B --> C[/speckit.specify]
    C --> D[/speckit.clarify - Optional]
    D --> E[/speckit.plan]
    E --> F{Human Review}
    F -->|Approve| G[/speckit.tasks]
    F -->|Revise| E
    G --> H[/speckit.implement]
    H --> I[Pull Request]
    I --> J{Code Review}
    J -->|Approve| K[Merge]
    J -->|Changes| H
    K --> L[Close Issue]
    L --> M[Update Knowledge Graph]
```

### Example: FalkorDB Health Monitoring Requirement

**Step 1**: Capture as GitHub Issue (YAML form)
```yaml
title: Add FalkorDB Health Monitoring to CI/CD
assignee-type: AI or Human
work-item-type: Feature
risk: Low
ambiguity: Medium
```

**Step 2**: Run `/speckit.specify` to create spec.md

**Step 3**: Optional - `/speckit.clarify` to address ambiguities:
- Should this be an MCP server or GitHub Action?
- Do we integrate with existing check_falkordb_health.py?
- What are alert thresholds and notification channels?

**Step 4**: Run `/speckit.plan` → Human reviews technical approach

**Step 5**: Run `/speckit.tasks` → Generate actionable breakdown

**Step 6**: Run `/speckit.implement` → Agent executes plan

**Step 7**: PR created with:
- Spec-SHA: [commit hash]
- Plan-SHA: [commit hash]
- Task checklist
- Human review required (per RBAC)

---

## Best Practices for Claude Code

### 1. Constitution First
Always establish `constitution.md` before feature work. This prevents:
- Inconsistent tech stack choices
- Violating security policies
- Over-engineering
- Skipping tests

### 2. Use `/speckit.clarify` Liberally
Before planning, run clarify to:
- Identify underspecified areas
- Ask targeted questions (max 5)
- Encode answers back into spec.md
- Reduce rework during implementation

### 3. Human Checkpoints Matter
**Mandatory reviews**:
- Plan review (High Ambiguity features)
- PR review (High Risk changes)
- Constitution updates (Governance changes)

**Auto-merge allowed**:
- Low Risk + Low Ambiguity refactors
- Documentation updates
- Test improvements

### 4. Link Everything
- Spec → Plan → Tasks → Code → PR
- Provides audit trail: "Why was this built this way?"
- Use GitHub Issues to track spec lineage

### 5. Capture Learnings in Graphiti
After completing spec-driven features:
```python
await graphiti.add_episode(
    name="Lesson: Spec-Driven Development with SpecKit",
    episode_body=json.dumps({
        "feature": "FalkorDB Health Monitoring",
        "spec_approach": "Started with constitution, clarified ambiguities before planning",
        "what_worked": "Early clarification prevented scope creep",
        "what_didnt": "Initial plan over-engineered, needed human review to simplify",
        "recommendation": "Always validate plan complexity against actual requirements"
    }),
    source=EpisodeType.json,
    group_id="graphiti_meta_knowledge"
)
```

---

## SpecKit + GitHub Native Operating Model

SpecKit integrates with the GitHub-Native Agentic Operating Model documented in:
`/home/donbr/graphiti-org/github-agentic-om/docs/github-native-operating-model.md`

**Key integration points**:

1. **Governance** (Part IV): RBAC ensures only humans merge to protected branches
2. **Strategic Planning** (Part V): GitHub Projects track Epics → Features → Stories → Tasks
3. **Specification** (Part VI): SpecKit provides the `/specify`, `/plan`, `/tasks` workflow
4. **Execution** (Part VII): Agents use git worktrees for parallel implementation
5. **BMAD Loop** (Part VIII): CI/CD validates spec conformance (contract testing, coverage)
6. **Knowledge** (Part IX): ADRs in `/docs/adr/` capture architectural decisions

---

## Installation & Setup

### Initialize with SpecKit CLI
```bash
# Install specify-cli
uv tool install specify-cli --from git+https://github.com/github/spec-kit.git

# Initialize project (if starting fresh)
specify init graphiti-fastmcp --ai claude

# For existing projects, add manually:
mkdir -p .specify
# Add constitution.md, specs as needed
```

### Claude Code Integration
SpecKit commands work natively in Claude Code as slash commands:
- `/speckit.constitution`
- `/speckit.specify`
- `/speckit.clarify`
- `/speckit.plan`
- `/speckit.tasks`
- `/speckit.implement`

No additional configuration needed - Claude Code detects SpecKit automatically.

---

## Supported AI Agents

SpecKit works with 17+ AI coding assistants:
- ✅ **Claude Code** (full support)
- ✅ GitHub Copilot
- ✅ Cursor
- ✅ Gemini CLI
- ✅ Cline
- ✅ Windsurf
- ⚠️ Amazon Q Developer CLI (limited support)

---

## Risk & Ambiguity Routing Matrix

From the GitHub-Native Operating Model, use this to determine human oversight:

| Task Type | Risk | Ambiguity | Workflow | Human Checkpoint |
|-----------|------|-----------|----------|------------------|
| **Well-Defined Refactor** | Low | Low | Autonomous AI | Auto-merge on pass |
| **New Feature** | Low | High | Supervised Plan | **Mandatory Plan Review** |
| **Security/Auth** | High | Low | Supervised Implement | **Mandatory PR Review** |
| **Production Bug** | High | High | Human-Only | **Human Intervention** |

**For graphiti-fastmcp**:
- FalkorDB health monitoring = Low Risk, Medium Ambiguity → **Plan Review Required**
- Documentation updates = Low Risk, Low Ambiguity → Auto-merge possible
- Authentication changes = High Risk → **Always require human PR review**

---

## Resources

### **GitHub SpecKit**
- **Repository**: https://github.com/github/spec-kit
- **README**: https://github.com/github/spec-kit/blob/main/README.md
- **GitHub Blog**: https://github.blog/ai-and-ml/generative-ai/spec-driven-development-with-ai-get-started-with-a-new-open-source-toolkit/

### **GitHub-Native Agentic Operating Model**
- **Repository**: https://github.com/donbr/github-agentic-om
- **README**: https://raw.githubusercontent.com/donbr/github-agentic-om/refs/heads/main/README.md
- **Operating Model (600+ line whitepaper)**: `/home/donbr/graphiti-org/github-agentic-om/docs/github-native-operating-model.md`
- **Key Components**:
  - Eight governing principles (PR-first, governance in SDLC, spec-as-contract)
  - Phased adoption playbook (Phases 0-4: human → assistant → autonomous)
  - Templates (PR templates, Cursor rules, branch protection)
  - RBAC matrix (human teams vs AI agent teams)
  - Risk & Ambiguity routing (when to require human oversight)

### **Claude Code & Agent SDK**
- **Claude Code Docs**: https://docs.claude.com/en/docs/agent-sdk/skills
- **Agent SDK Overview**: https://docs.claude.com/en/docs/agent-sdk/overview
- **Subagents**: https://docs.claude.com/en/docs/agent-sdk/subagents

### **Project-Specific**
- **This Project**: `/home/donbr/graphiti-fastmcp/`
- **Blog Posts**: `blog/` (session learnings and architectural analyses)
- **Architecture**: `architecture/` (generated by ra_orchestrators)
- **Reference**: `reference/` (knowledge base and best practices)

---

## Quick Reference

```bash
# Start new feature
/speckit.specify

# Clarify ambiguities
/speckit.clarify

# Generate technical plan
/speckit.plan

# Break into tasks
/speckit.tasks

# Implement
/speckit.implement

# Capture learnings
# Add episode to Graphiti with lessons learned
```

---

**Last Updated**: November 30, 2025
**Maintained By**: graphiti-fastmcp project team
**Related**: `.claude/commands/`, `blog/`, `architecture/`